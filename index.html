<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="SafePatch is an interactive release gate: drag a raw patch proposal, watch the certified patch update live, and get an immediate ship or hold recommendation."
    />
    <title>SafePatch | Live Release Gate</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@500;600&family=Manrope:wght@400;500;600;700&family=Instrument+Serif:ital@0;1&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="shell">
      <header class="hero" aria-label="SafePatch intro">
        <p class="brand">SafePatch</p>
        <h1>Can this hotfix reduce incidents without breaking policy?</h1>
        <p class="hero-copy">
          Drag the proposed patch in the main frame. SafePatch trims only the unsafe component, forecasts operational
          impact, and returns a clear ship-or-hold call.
        </p>
      </header>

      <section class="stage-shell" aria-label="SafePatch interactive stage">
        <div class="control-row" role="group" aria-label="Simulation controls">
          <div class="preset-row" role="group" aria-label="Release conditions">
            <button class="preset-btn" data-preset="normal" data-pressure="0.24" type="button">Baseline</button>
            <button class="preset-btn active" data-preset="spike" data-pressure="0.56" type="button">Spike</button>
            <button class="preset-btn" data-preset="incident" data-pressure="0.9" type="button">Incident</button>
          </div>

          <label class="tightness-label" for="tightness-slider">
            Policy strictness
            <span id="tightness-value">62%</span>
          </label>
          <input id="tightness-slider" type="range" min="20" max="90" value="62" />

          <div class="mode-toggle" role="group" aria-label="View mode">
            <button class="mode-btn active" data-mode="geometry" type="button">Impact</button>
            <button class="mode-btn" data-mode="forces" type="button">Forces</button>
          </div>

          <button id="replay-button" class="replay-btn" type="button">Replay demo</button>
        </div>

        <p id="preset-note" class="preset-note">Traffic spike: proposed patch likely helps users but risks operational load.</p>

        <div id="frame-card" class="frame-card">
          <canvas id="scene-canvas" class="scene-canvas" aria-label="Raw patch and safe patch projection"></canvas>

          <div class="frame-story" aria-live="polite">
            <p id="frame-step" class="frame-step">Testing proposed patch against live policy checks.</p>
            <p id="frame-sub" class="frame-sub">Drag the patch handle to see impact and recommendation update instantly.</p>
          </div>
        </div>

        <section class="outcome-strip" aria-label="Outcome summary">
          <article id="decision-card" class="metric-card decision-card hold">
            <p id="decision-pill" class="decision-pill hold">HOLD</p>
            <p id="decision-title" class="decision-title">Raw patch is not certifiable yet</p>
            <p id="decision-detail" class="decision-detail">SafePatch keeps useful movement and removes unsafe movement.</p>
            <p id="readiness-note" class="metric-footnote">Release confidence: --</p>
          </article>

          <article class="metric-card">
            <p class="metric-label">Checks passed</p>
            <strong id="checks-value" class="metric-value">--</strong>
          </article>

          <article class="metric-card">
            <p class="metric-label">Incident forecast (safe)</p>
            <strong id="incident-value" class="metric-value">--</strong>
          </article>

          <article class="metric-card">
            <p class="metric-label">Useful gain kept</p>
            <strong id="retained-value" class="metric-value">--</strong>
          </article>
        </section>

        <section id="force-bars" class="force-bars hidden" aria-label="Active guardrail forces"></section>
      </section>

      <details class="details-panel">
        <summary>Details</summary>

        <section class="details-grid">
          <article class="detail-card">
            <h3>Why this decision</h3>
            <ul id="why-list" class="detail-list">
              <li>Drag the stage to generate rationale.</li>
            </ul>
          </article>

          <article class="detail-card">
            <h3>Recommended actions</h3>
            <ul id="action-list" class="detail-list">
              <li>Adjust the proposal direction and compare outcomes.</li>
            </ul>
          </article>
        </section>

        <section class="memo-card">
          <div class="memo-head">
            <p class="overlay-kicker">Release memo</p>
            <button id="copy-memo-button" class="small-btn" type="button">Copy memo</button>
          </div>
          <p id="memo-text" class="memo-text">Memo updates as you interact.</p>
          <button id="export-button" class="small-btn" type="button">Export decision JSON</button>
        </section>
      </details>
    </main>

    <script type="module" src="./src/main.ts"></script>
  </body>
</html>
